<!DOCTYPE html>
<html>
<head>
    <title>AR.js Marker-Based AR</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aframe/1.4.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
        .arjs-loader {
            position: fixed;
            z-index: 999;
            overflow: show;
            margin: auto;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .arjs-loader div {
            text-align: center;
            font-size: 1.25em;
            color: white;
        }

        .button-container {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 999;
            display: flex;
            gap: 10px;
        }

        button {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background: #0056b3;
        }
    </style>
</head>

<body style="margin: 0; overflow: hidden;">
    <!-- Loading screen -->
    <div class="arjs-loader">
        <div>Loading AR Experience...</div>
    </div>

    <!-- Control buttons -->
    <div class="button-container">
        <button onclick="scaleUp()">Scale Up</button>
        <button onclick="scaleDown()">Scale Down</button>
        <button onclick="rotateLeft()">Rotate Left</button>
        <button onclick="rotateRight()">Rotate Right</button>
    </div>

    <!-- A-Frame scene -->
    <a-scene
        embedded
        arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;"
        renderer="logarithmicDepthBuffer: true;"
        vr-mode-ui="enabled: false">

        <!-- Custom marker - Replace 'pattern-hiro' with your custom marker if needed -->
        <a-marker id="animated-marker" type="pattern" preset="hiro">
            <!-- 3D model -->
            <a-entity
                id="model"
                position="0 0 0"
                scale="1 1 1"
                rotation="0 0 0"
                gltf-model="path/to/your/model.gltf">
            </a-entity>
            
            <!-- Example primitive shapes -->
            <a-box
                id="box"
                position="0 0.5 0"
                material="color: #4CC3D9"
                visible="true">
            </a-box>

            <a-sphere
                id="sphere"
                position="0 1 0"
                radius="0.5"
                material="color: #EF2D5E"
                visible="false">
            </a-sphere>

            <a-cylinder
                id="cylinder"
                position="0 0.5 0"
                radius="0.5"
                height="1"
                material="color: #FFC65D"
                visible="false">
            </a-cylinder>
        </a-marker>

        <!-- Camera -->
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        window.onload = function() {
            // Hide loader when scene is loaded
            const scene = document.querySelector('a-scene');
            const loader = document.querySelector('.arjs-loader');
            scene.addEventListener('loaded', function () {
                loader.style.display = 'none';
            });

            // Get marker element
            const marker = document.querySelector("#animated-marker");

            // Add marker found/lost event listeners
            marker.addEventListener('markerFound', function() {
                console.log('Marker Found');
                // You can add custom behavior when marker is found
            });

            marker.addEventListener('markerLost', function() {
                console.log('Marker Lost');
                // You can add custom behavior when marker is lost
            });
        };

        // Object manipulation functions
        let currentScale = 1;
        let currentRotation = 0;
        const scaleStep = 0.2;
        const rotationStep = 15;

        function scaleUp() {
            currentScale += scaleStep;
            updateTransform();
        }

        function scaleDown() {
            currentScale = Math.max(0.2, currentScale - scaleStep);
            updateTransform();
        }

        function rotateLeft() {
            currentRotation -= rotationStep;
            updateTransform();
        }

        function rotateRight() {
            currentRotation += rotationStep;
            updateTransform();
        }

        function updateTransform() {
            const box = document.querySelector('#box');
            const sphere = document.querySelector('#sphere');
            const cylinder = document.querySelector('#cylinder');
            const model = document.querySelector('#model');

            // Update all objects
            [box, sphere, cylinder, model].forEach(object => {
                if (object) {
                    object.setAttribute('scale', `${currentScale} ${currentScale} ${currentScale}`);
                    object.setAttribute('rotation', `0 ${currentRotation} 0`);
                }
            });
        }

        // Object switching functions
        let currentObject = 'box';

        function switchObject(objectType) {
            // Hide all objects
            document.querySelector('#box').setAttribute('visible', false);
            document.querySelector('#sphere').setAttribute('visible', false);
            document.querySelector('#cylinder').setAttribute('visible', false);
            document.querySelector('#model').setAttribute('visible', false);

            // Show selected object
            document.querySelector(`#${objectType}`).setAttribute('visible', true);
            currentObject = objectType;
        }
    </script>
</body>
</html>
